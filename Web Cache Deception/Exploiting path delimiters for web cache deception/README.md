## Lab Description :

![image](https://github.com/user-attachments/assets/72915388-fa95-4541-a51d-345f4bfdf33a)

## Solution :

Login to the site using the credentils - `wiener:peter`.

The `/my-account` page has the API key of the logged in user.

### Analyzing behaviour of Origin server -

The Origin server used here is **Apache Coyote** which is built using **Java**.

![image](https://github.com/user-attachments/assets/33d7d9bb-7504-437e-a27b-1118d68d4a56)

When we try to append random characters in URI, the application returns **404 NOT FOUND**.

![image](https://github.com/user-attachments/assets/dd20ab3e-9690-4650-b9aa-d69840aa4e2e)

For Java based applications, the delimiter used is `;`. The path `my-account;abc.js` would be treated as `/my-account` by the Origin server . In this case, the Apache Coyote server.

![image](https://github.com/user-attachments/assets/06dfa57c-0847-421e-b42a-0a62efc2936c)

So from our understanding, we can craft a payload such that the origin server truncates anything after `my-account;` but the cache server considers the URI as path to a static resource & caches the response.

Send the following payload to Carlos using exploit server,

```js
<script>document.location="https://0a58007d0382174983bf10b9000c00a3.web-security-academy.net/my-account;exploit.js"</script>
```
After carlos clicks the link, We can now access the same URL unauthenticated to retreive the API key of carlos.

![image](https://github.com/user-attachments/assets/2b767e5f-b00f-4fd8-ab59-9061b543cea3)

Submit the API key to solve the lab.

![image](https://github.com/user-attachments/assets/60b79204-c942-4d91-b46e-7ad3f91acd78)
